<form name="editForm" role="form" novalidate (ngSubmit)="save()" #editForm="ngForm">
  <div class="modal-header">
    <h4 class="modal-title" *ngIf="xmEntity?.id" jhiTranslate="xm.xmEntity.edit.title" translateValues="{name: '{{xmEntity?.name}}'}">
      Edit a entity [<b>{{xmEntity.name}}</b>]
    </h4>

    <h4 class="modal-title" *ngIf="!xmEntity?.id" jhiTranslate="xm.xmEntity.add.title">
      Add a new entity
    </h4>
  </div>
  <div class="modal-body">
    <div class="form-group" [hidden]="true">
      <label for="id" jhiTranslate="global.field.id">ID</label>
      <input type="text" class="form-control" id="id" name="id"
             [(ngModel)]="xmEntity.id" readonly/>
    </div>

    <div class="form-group" *ngIf="!xmEntity.id">
      <select name="typeKey" id="field_typeKey" class="form-control selectpicker" data-style="btn btn-primary btn-round"
              [(ngModel)]="xmEntity.typeKey" data-size="7" required>
        <option disabled><span jhiTranslate="xm.xmEntity.add.chooseType">Choose entity type</span></option>
        <option [ngValue]="entityType.key"
                *ngFor="let entityType of entityTypes"
                [attr.selected]="xmEntity && entityType.key == xmEntity.typeKey ? true : null" >
          {{(entityType.name | name: principal)?.toUpperCase()}}
        </option>
      </select>
      <div [hidden]="!(editForm.controls.typeKey?.dirty && editForm.controls.typeKey?.invalid)">
        <small class="form-text text-danger"
               [hidden]="!editForm.controls.typeKey?.errors?.required" jhiTranslate="entity.validation.required">
          This field is required.
        </small>
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="xm.xmEntity.name" for="field_name">Name</label>
      <input type="text" class="form-control" name="name" id="field_name"
             [(ngModel)]="xmEntity.name" required/>
      <div [hidden]="!(editForm.controls.name?.dirty && editForm.controls.name?.invalid)">
        <small class="form-text text-danger"
               [hidden]="!editForm.controls.name?.errors?.required" jhiTranslate="entity.validation.required">
          This field is required.
        </small>
      </div>
    </div>

    <div class="form-group">
      <label class="form-control-label" jhiTranslate="xm.xmEntity.description" for="field_description">
        Description
      </label>
      <input type="text" class="form-control" name="description" id="field_description"
             [(ngModel)]="xmEntity.description"/>
    </div>

    <json-schema-form
      class="entity-list-json-form"
      [framework]="'bootstrap-3'"
      [schema]="formData.schema"
      [layout]="formData.layout"
      (onChanges)="onChangeForm($event)"
      (formLayout)="showFormLayoutFn($event)"
      *ngIf="!xmEntity.id && formData"
    >
    </json-schema-form>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal" (click)="clear()">
      <span jhiTranslate="entity.action.cancel">Cancel</span>
    </button>
    <button type="submit" [disabled]="editForm.form.invalid || isSaving" class="btn btn-primary">
      <span jhiTranslate="entity.action.save">Save</span>
    </button>
  </div>
</form>
